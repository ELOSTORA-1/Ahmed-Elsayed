#!/bin/bash

# Fitch Domain TO Get His User Password.
Input_domain=$1

# Get The Username By His Domain
User=$(grep -i $Input_domain /etc/domainusers | awk '{print $1}' | tr -d ":" )


if [ -z "$User" ]; then
    echo "Error: Domain not found in /etc/domainusers"
    exit 1
fi

# Change Password For this User
password=$(openssl rand -base64 16 | tr -d "=")

passwd "$User" <<EOF
$password
$password
EOF


# Check if password change was successful
if [ $? -eq 0 ]; then
    echo "Password changed successfully for user: $User"
    echo "Username: $User"
    echo "Password: $password"
else
    echo "Error: Failed to change password for user: $User"
    exit 1
fi